<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Untitled</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">IDR4000 Course notes</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lessons
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="lesson_1_installation.html">Installing and starting up R and RStudio</a>
    </li>
    <li>
      <a href="lesson_2_markdown.html">Creating a report using rmarkdown</a>
    </li>
    <li>
      <a href="lesson_3_structure.html">Structuring an analysis</a>
    </li>
    <li>
      <a href="lesson_4_scripts.html">R scripts and R markdown files</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="lesson_5_import_data.html">Import data</a>
    </li>
    <li>
      <a href="lesson_6_make_summaries.html">Make summaries of data</a>
    </li>
    <li>
      <a href="lesson_7_ggplot2.html">Making figures</a>
    </li>
    <li>
      <a href="lesson_8_making_tables.html">Making tables</a>
    </li>
    <li>
      <a href="lesson_9_git.html">Version control and GitHub</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="lesson_10_inference.html">Introduction to statistical inference</a>
    </li>
    <li>
      <a href="lesson_11_inference2.html">Statistical inference, p-values and confidence intervals</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="lesson_12_regressionModels.html">Regression models part 1</a>
    </li>
    <li>
      <a href="lesson_13_regressionModels2.html">Regression models part 2: Lactate threshold analysis</a>
    </li>
    <li>
      <a href="lesson_14_correlation.html">Regression models and correlations</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="ex1_1_intro.html">Basic R</a>
    </li>
    <li>
      <a href="ex1_2_import.html">Importing data</a>
    </li>
    <li>
      <a href="ex1_3_summarise.html">Summarise data</a>
    </li>
    <li>
      <a href="ex1_4_figures.html">Making figures</a>
    </li>
    <li>
      <a href="ex1_5_group_exercise.html">Group exercises</a>
    </li>
    <li>
      <a href="ex2_1_inference.html">Inference</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Assignments
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="assignment_1_descriptives.html">Descriptive data</a>
    </li>
    <li>
      <a href="feedback_1.html">Feedback assignment 1</a>
    </li>
    <li>
      <a href="assignment_2_inference.html">Inference</a>
    </li>
    <li>
      <a href="feedback_2.html">Feedback assignment 2</a>
    </li>
    <li>
      <a href="assignment_3_regression.html">Regression models</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="faq.html">
    <span class="fa fa-question fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Untitled</h1>

</div>


<script language="javascript"> 
    function toggle(num) {
      var ele = document.getElementById("toggleText" + num);
      var text = document.getElementById("displayText" + num);
      if(ele.style.display == "block") {
        ele.style.display = "none";
        text.innerHTML = "show";
      }
      else {
        ele.style.display = "block";
        text.innerHTML = "hide";
      }
   } 
  </script>
<div id="exercise-1" class="section level1">
<h1>Exercise 1</h1>
<p>A t-test is suitable for comparing a single mean to an hypothesized mean or two means to each other. If using two means these may be collected from paired observation (the same individuals) or from independent samples (two different groups).</p>
<p>In these examples we will work with the data set from Haun et al. 2019. To download and load the data set:</p>
<pre class="r"><code>library(tidyverse)
download.file(&quot;https://ndownloader.figstatic.com/files/14702420&quot;, destfile = &quot;./data/hypertrophy.csv&quot;)

hypertrophy &lt;- read_csv(&quot;./data/hypertrophy.csv&quot;)</code></pre>
<p>We will start by looking at the variables <code>SUB_ID</code>, <code>CLUSTER</code> and <code>T3T1_PERCENT_CHANGE_RNA</code>. These variables can be selected by using the code below.</p>
<pre class="r"><code>hyp1 &lt;- hypertrophy %&gt;%
  select(SUB_ID, CLUSTER, T3T1_PERCENT_CHANGE_RNA) %&gt;%
  print()</code></pre>
<p>The <code>T3T1_PERCENT_CHANGE_RNA</code> variable is the percentage change in total RNA content per muscle weight from the beginning to the end of the training period.</p>
<p>Using all participants, let’s say that we want to assess if training increases RNA content. What kind of test would you use and how can we formulate a null hypothesis using this limited data?</p>
<p>Try to write <code>?t.test</code> in the console to read the help pages for the t.test if you are not sure.</p>
<a id="displayText" href="javascript:toggle(1);">Here is a possible solution</a>
<div id="toggleText1" style="display: none">
<p>A one sample t-test can be used to test is a mean differs from a nulll hypothesis. Above we state a directional question “if training <em>increases</em> RNA content”. If we want to keep this direction in the statistical hypothesis we want to use a one sample, one-tailed t-test with a directional alternative hypothesis <code>alternative = "greater"</code>.</p>
<p>We could also be open to the hypothesis that RNA content can be lower or higher than 0. This would imply a two-tailed test, only testing difference (<code>alternative = "two.sided"</code>).</p>
<p>Since the variable of interest is calculated as a change (in percentage) the null hypothesis of no change equals 0 in percentage change.</p>
<pre class="r"><code># To acces the specific variable 
t.test(hyp1$T3T1_PERCENT_CHANGE_RNA, mu = 0, alternative = &quot;two.sided&quot;)</code></pre>
<p>The confidence interval together with the p-value suggests that this result, or an even more extreme results is improbable if the null hypothesis is true.</p>
</div>
<p></br></p>
</div>
<div id="exercise-2" class="section level1">
<h1>Exercise 2</h1>
<p>The same test can be perfomed using the raw data. We will use the raw variables to test in RNA changes with training. The variables of interest are:</p>
<pre class="r"><code>hyp2 &lt;- hypertrophy %&gt;%
  select(SUB_ID, CLUSTER, T1_RNA, T3_RNA) %&gt;%
  print()</code></pre>
<p>Using this new data set, how would you test if RNA changes wit training. What kind of test do you choose?</p>
<a id="displayText" href="javascript:toggle(2);">Here is a possible solution</a>
<div id="toggleText2" style="display: none">
<p>The data are paired, meaning that we now have two data points from each participant. In the t-test function we need to specify <code>paired = TRUE</code> in this case. The null hypothesis can still be directional or “two.sided”.</p>
<pre class="r"><code>t.test(hyp2$T3_RNA, hyp2$T1_RNA, paired = TRUE, alternative = &quot;two.sided&quot;)</code></pre>
<p>How does this correspond to the test of percentage change above?</p>
</div>
<p></br></p>
</div>
<div id="exercise-3" class="section level1">
<h1>Exercise 3</h1>
<p>An independent, two sample t-test compares means from two groups that are not in any meaningful way related.</p>
<p>Calculate any difference of RNA increases between T1 and T3 between the <code>HIGH</code> and <code>LOW</code> cluster group. Are the groups different (at the population level)?</p>
<a id="displayText" href="javascript:toggle(3);">Here is a possible solution</a>
<div id="toggleText3" style="display: none">
<p>We could use the change score, not converted to percentages to compare the groups. We have to remove participants not belonging to any group.</p>
<pre class="r"><code>hyp3 &lt;- hypertrophy %&gt;%
  select(SUB_ID, CLUSTER, T3T1__RNA) %&gt;%
  filter(!is.na(CLUSTER)) %&gt;%
  print()</code></pre>
<p>The t-test can now be used with a formula. We want to explain the variable <code>T3T1__RNA</code> with the grouping variable (<code>CLUSTER</code>). In R we can write this as a formula <code>T3T1__RNA  ~ CLUSTER</code>. In the help-pages of <code>t.test</code>we can see that a method exists for class formula. This means that the function can be used differently than what we have previously done. Notice also that the data argument is needed since we do not enter the data directly.</p>
<pre class="r"><code>t.test(T3T1__RNA  ~ CLUSTER, data = hyp3)</code></pre>
<p>What conclusions do you draw from the results?</p>
<a id="displayText" href="javascript:toggle(31);">Here is a possible solution</a>
<div id="toggleText31" style="display: none">
<p>The mean increase in the LOW group is slightly higher than in the HIGH group, however the results are not so different than what would be expected in the null hypothesis was true. We do not have strong evidence against the null</p>
<p>It is a good idea to plot the data to see what is going on. A simple boxplot will tell the story</p>
<pre class="r"><code>hyp3 %&gt;%
  ggplot(aes(CLUSTER, T3T1__RNA)) + geom_b</code></pre>
</div>
<p></br></p>
</div>
<p></br></p>
</div>
<div id="exercise-4" class="section level1">
<h1>Exercise 4</h1>
<p>When writing up results it is good practice to include the test statistic together with a mean difference, a confidence interval and a p-value.</p>
<p>How can you use R to get all these values from a single test? Use the t-test performed in exercise 2 to get all values from the test function.</p>
<a id="displayText" href="javascript:toggle(4);">Here is a possible solution</a>
<div id="toggleText4" style="display: none">
<pre class="r"><code># First, save the test in an object

ttest &lt;- t.test(hyp2$T3_RNA, hyp2$T1_RNA, paired = TRUE, alternative = &quot;two.sided&quot;)


# the test statistic
ttest$statistic

# Mean difference 
ttest$estimate

# Confidence interval
ttest$conf.int

# The confidence interval is two numbers the upper and the lower value
# to get only the lower
ttest$conf.int[1]

# And the upper
ttest$conf.int[2]

# And finally the p-value
ttest$p.value</code></pre>
</div>
<p></br></p>
</div>
<div id="exercise-5" class="section level1">
<h1>Exercise 5</h1>
<p>When writing results in R markdown we can add results from a test automatically in the test. Try to write Rmarkdown combined with R code to create the following output:</p>
<blockquote>
<p>Total RNA content increased from T1 to T3 with 90.5 units (95% CI: [51.5, 129.5], t(29) = 4.74, p = 0).</p>
</blockquote>
<a id="displayText" href="javascript:toggle(5);">Here is a possible solution</a>
<div id="toggleText5" style="display: none">
<p>I first saves the t-test in an oject from where I save all values that I’m interested in.</p>
<pre class="r"><code>hypertrophy &lt;- read_csv(&quot;./data/hypertrophy.csv&quot;)

hyp2 &lt;- hypertrophy %&gt;%
  select(SUB_ID, CLUSTER, T1_RNA, T3_RNA) 

# First, save the test in an object
ttest &lt;- t.test(hyp2$T3_RNA, hyp2$T1_RNA, paired = TRUE, alternative = &quot;two.sided&quot;)


# degress of freedom
df &lt;- ttest$parameter
# the test statistic
statistic &lt;- ttest$statistic
# Mean difference 
estimate &lt;- ttest$estimate
# Confidence interval
ci &lt;- ttest$conf.int
# And finally the p-value
pval &lt;- ttest$p.value</code></pre>
<p>I then write up a section combining text and R code</p>
<pre class="r"><code>Total RNA content increased from T1 to T3 with `r round(estimate, 1)` units (95% CI: [`r round(ci[1], 1)`, `r round(ci[2], 1)`], t(`r df`) = `r round(statistic,2)`, p = `r round(pval, 3)`).</code></pre>
</div>
<p></br></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
