<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Mixed models - Interpretation and visualization</title>

<script src="site_libs/header-attrs-2.4/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">IDR4000 Course notes</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lessons
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="lesson_1_installation.html">Installing and starting up R and RStudio</a>
    </li>
    <li>
      <a href="lesson_2_markdown.html">Creating a report using rmarkdown</a>
    </li>
    <li>
      <a href="lesson_3_structure.html">Structuring an analysis</a>
    </li>
    <li>
      <a href="lesson_4_scripts.html">R scripts and R markdown files</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="lesson_5_import_data.html">Import data</a>
    </li>
    <li>
      <a href="lesson_6_make_summaries.html">Make summaries of data</a>
    </li>
    <li>
      <a href="lesson_7_ggplot2.html">Making figures</a>
    </li>
    <li>
      <a href="lesson_8_making_tables.html">Making tables</a>
    </li>
    <li>
      <a href="lesson_9_git.html">Version control and GitHub</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="lesson_10_inference.html">Introduction to statistical inference</a>
    </li>
    <li>
      <a href="lesson_11_inference2.html">Statistical inference, p-values and confidence intervals</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="lesson_12_regressionModels.html">Regression models part 1</a>
    </li>
    <li>
      <a href="lesson_13_regressionModels2.html">Regression models part 2: Lactate threshold analysis</a>
    </li>
    <li>
      <a href="lesson_14_correlation.html">Regression models and correlations</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="lesson_15_analyzingTrials.html">Analyzing pre- to post-experiments</a>
    </li>
    <li>
      <a href="lesson_16_mixed_models.html">Analyzing trials with mixed-model</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="ex1_1_intro.html">Basic R</a>
    </li>
    <li>
      <a href="ex1_2_import.html">Importing data</a>
    </li>
    <li>
      <a href="ex1_3_summarise.html">Summarise data</a>
    </li>
    <li>
      <a href="ex1_4_figures.html">Making figures</a>
    </li>
    <li>
      <a href="ex1_5_group_exercise.html">Group exercises</a>
    </li>
    <li>
      <a href="ex2_1_inference.html">Inference</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Assignments
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="assignment_1_descriptives.html">Descriptive data</a>
    </li>
    <li>
      <a href="feedback_1.html">Feedback assignment 1</a>
    </li>
    <li>
      <a href="assignment_2_inference.html">Inference</a>
    </li>
    <li>
      <a href="feedback_2.html">Feedback assignment 2</a>
    </li>
    <li>
      <a href="assignment_3_regression.html">Regression models</a>
    </li>
    <li>
      <a href="assignment_4_repeated.html">Repeated measures studies</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="faq.html">
    <span class="fa fa-question fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Mixed models - Interpretation and visualization</h1>

</div>


<style>
p.caption {
  font-size: 0.8em;
}
</style>
<script language="javascript"> 
    function toggle(num) {
      var ele = document.getElementById("toggleText" + num);
      var text = document.getElementById("displayText" + num);
      if(ele.style.display == "block") {
        ele.style.display = "none";
        text.innerHTML = "show";
      }
      else {
        ele.style.display = "block";
        text.innerHTML = "hide";
      }
   } 
  </script>
<div id="a-multiple-time-point-study" class="section level1">
<h1>A multiple time-point study</h1>
<p>In previous lessons where we used ANCOVA models to account for the baseline we were able to get away with a simple linear regression model. This because we modeled the change- or post-scores, we did not get any correlated errors (not multiple data points from each participant). The <code>ten_vs_thirty.xlsx</code> data set contains three time-points per participant, it is thus not straight forward to put all this data in one model as the data are correlated. As we saw in a previous lesson, not accounting for the correlation in repeated measures studies could affect statistical power.</p>
<p>In this lesson we will model strength data with a linear mixed model (LMM). We will interpret the output and make plots of the model estimates.</p>
<div id="an-hypothetical-example" class="section level2">
<h2>An hypothetical example</h2>
<p>A theoretical outcome of the study in this example could look something like in Figure 1 below.</p>
<p><img src="lesson_17_mixed_models2_files/figure-html/unnamed-chunk-1-1.png" width="1800" style="display: block; margin: auto;" /></p>
<p>The 30RM group starts off at approximately the same level as the 10RM group. After the first period (from Pre to Mid) the 10RM group potentially increases strength more than the 30RM group, the difference could be maintained to the Post time-point.</p>
<p>Instead of modeling the effect of the baseline on the outcome we could control for it by adjusting the average levels at Mid and Post by removing the differences seen at baseline. This is the basic approach when analyzing repeated measures deigns with mixed models. Before we get to this step we will build the model from the bottom up.</p>
<p>In a first model we do not include any “fixed effects”. We only estimate the mean of the whole data set, the very basic model formulation could look some thing like:</p>
<p><span class="math display">\[y = \beta_0\]</span> In R, we would write this model formula as</p>
<pre class="r"><code>strength ~ 1</code></pre>
<p>given that the dependent variable (y) is a variable we call strength. The number 1 indicates that we only include an intercept in the model. Thus, the data are explained with an intercept only. In the figure below, this model is represented by the black cross.</p>
<p>We could add information about the time-points to the model, still leaving out information regarding grouping. This model formulation could look something like this:</p>
<p><span class="math display">\[y = \beta_0 + \beta_{Mid} + \beta_{Post}\]</span> Where <span class="math inline">\(\beta_{Mid}\)</span> is a dummy variable assigned number 1 when time = “mid” otherwise 0, and <span class="math inline">\(\beta_{Post}\)</span> is a dummy variable assigned 1 when time = “post” otherwise 0. This model, given our hypothetical data in this example could look like the black line in the plot below.</p>
<p>In R, we would write this model formula as</p>
<pre class="r"><code>strength ~ time</code></pre>
<p>R automatically converts the time variable to two dummy variables as described in the formula above.</p>
<div class="figure" style="text-align: center">
<img src="lesson_17_mixed_models2_files/figure-html/unnamed-chunk-4-1.png" alt="Figure 2. Hypothetical model of a study strength development in two groups. The black cross represents a model of the data only modelling the mean, the black line represents a model modelling the average change over time in the two groups. Hypothetical values per group and time are represented in colored lines" width="1800" />
<p class="caption">
Figure 2. Hypothetical model of a study strength development in two groups. The black cross represents a model of the data only modelling the mean, the black line represents a model modelling the average change over time in the two groups. Hypothetical values per group and time are represented in colored lines
</p>
</div>
<p>To account for the difference between groups at baseline we could add an estimate of the effect of baseline differences. In a simplified description this could look like:</p>
<p><span class="math display">\[y = \beta_0 + \beta_{Group} + \beta_{Mid} + \beta_{Post}\]</span> Where the additional <span class="math inline">\(\beta_{Group}\)</span> is a dummy variable assigning 1 to all observations in the 30RM group and 0 otherwise. In R we extend the model formulation simply by adding group:</p>
<p>In R, we would write this model formula as</p>
<pre class="r"><code>strength ~ group + time </code></pre>
<p>Estimates from the new model will have one “line” per group representing the average difference between groups at baseline but not accounting for differences in changes over time per group. The two black dashed lines in Figure 3 represents this model.</p>
<div class="figure" style="text-align: center">
<img src="lesson_17_mixed_models2_files/figure-html/unnamed-chunk-6-1.png" alt="Figure 3. Hypothetical model of a study strength development in two groups. The black cross represents a model of the data only modelling the mean, the solid black line represents a model modelling the average change over time in the two groups. The dashed black lines represents the average change over time with baseline difference between groups at baseline accounted for. Hypothetical values per group and time are represented in colored lines" width="1800" />
<p class="caption">
Figure 3. Hypothetical model of a study strength development in two groups. The black cross represents a model of the data only modelling the mean, the solid black line represents a model modelling the average change over time in the two groups. The dashed black lines represents the average change over time with baseline difference between groups at baseline accounted for. Hypothetical values per group and time are represented in colored lines
</p>
</div>
<p>Notice that the addition of the group term creates two parallel lines representing each group. To fully capture the average changes per group we need to let the model account for different changes per time in each group. We do this by adding an “interaction term”. The interaction term allows for each group to have different values at “Mid” and “Post”.</p>
<p>A simplified model formulation could look like this:</p>
<p><span class="math display">\[y = \beta_0 + \beta_{Group} + \beta_{Mid} + \beta_{Post} + \beta_{Mid:Group} + \beta_{Post:Group}\]</span></p>
<p>In R, we would write this model formula as</p>
<pre class="r"><code>strength ~ group + time + group:time</code></pre>
<p>We may also simplify the above formula like this:</p>
<pre class="r"><code>strength ~ group * time </code></pre>
<p>The output from this model given our hypothetical data could look like in table 1.</p>
<table>
<caption>Table 1. Regression coefficients from an hypothetical data set.</caption>
<thead>
<tr class="header">
<th align="left">Coefficient</th>
<th align="right">Estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Intercept</td>
<td align="right">0.45</td>
</tr>
<tr class="even">
<td align="left">TimeMid</td>
<td align="right">0.15</td>
</tr>
<tr class="odd">
<td align="left">TimePost</td>
<td align="right">0.20</td>
</tr>
<tr class="even">
<td align="left">Group10RM</td>
<td align="right">0.05</td>
</tr>
<tr class="odd">
<td align="left">TimeMid:Group10RM</td>
<td align="right">0.15</td>
</tr>
<tr class="even">
<td align="left">TimePost:Group10RM</td>
<td align="right">0.20</td>
</tr>
</tbody>
</table>
<p>The 30RM group is the reference group so the intercept estimate is the mean in this group at the Pre time point. The 30RM group increases by 0.15 units from Pre to Mid and 0.20 units from Pre to Post. At Pre, the 10RM group is 0.05 units above the 30RM group. Compared to the change seen in the 30RM group, the 10RM group increases an additional 0.15 points Pre to Mid and an additional 0.20 units from Pre to Post.</p>
<p>To calculate the average in the 30RM group at Mid we can combine estimates from the regression table (above) according to our model formula. Keeping only the terms needed</p>
<p><span class="math display">\[y = \beta_0 + \beta_{Mid} \]</span> <span class="math display">\[y = 0.45 + 0.15\]</span></p>
<p><span class="math display">\[y = 0.6\]</span> The same principles apply if we want to know the estimated mean in the 10RM group at Post, keeping the relevant terms:</p>
<p><span class="math display">\[y = \beta_0 + \beta_{Group}  + \beta_{Post} + \beta_{Post:Group}\]</span> <span class="math display">\[y=0.45 + 0.05 + 0.2 + 0.2\]</span> <span class="math display">\[y=0.9\]</span> By adding up the terms in a linear fashion (hence linear regression) we can calculate the estimated averages from both groups.</p>
<p>The final model allows for different changes over time per group. And different regression estimates will reflect these patterns (Figure 4).</p>
<div class="figure" style="text-align: center">
<img src="lesson_17_mixed_models2_files/figure-html/unnamed-chunk-10-1.png" alt="Figure 4. Hypothetical model of a study on strength development in two groups. The dashed colored lines represents the average change over time per group with baseline difference between groups at baseline accounted for. Regression terms are printed to represent a full interaction model describing the data." width="1800" />
<p class="caption">
Figure 4. Hypothetical model of a study on strength development in two groups. The dashed colored lines represents the average change over time per group with baseline difference between groups at baseline accounted for. Regression terms are printed to represent a full interaction model describing the data.
</p>
</div>
</div>
<div id="inference-from-a-repeated-measures-study" class="section level2">
<h2>Inference from a repeated measures study</h2>
<p>In the scenario described above the most meaningful comparison between groups are the differences in change over time between groups. This is because our design let us do this comparison. A comparison that is much more uncertain in a study like this is the within-group changes over time. This is because we do not have a control condition for comparison. Imagine that our example above the two groups are both training, coparing the two groups means thta we are comparing two different training protocols. We might be tempted to say that the average increase in strength is due to the training, however, strictly speaking this problematic as we do not have a group of randomly assigned individuals who have performed all tests but not performed the training. The effect we see on strength on average could be an effect of learning the strength test. We can not isolate the training effect from other effects when we do not have a control group!</p>
<p>In comparing the two training protocols we do have control as we are comparing the two groups to each other.</p>
<div id="evaluating-regression-coefficients" class="section level3">
<h3>Evaluating regression coefficients</h3>
<p>In the hypothetical example above the two coefficients that are of interest are the two interaction estimates. Let’s evaluate their confidence intervals. Table 2 gives hypothetical 95% confidence intervals on the interaction terms.</p>
<table>
<caption>Table 2. Interaction coefficients from an hypothetical data set.</caption>
<thead>
<tr class="header">
<th align="left">Coefficient</th>
<th align="right">Estimate</th>
<th align="left">95% CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">TimeMid:Group10RM</td>
<td align="right">0.15</td>
<td align="left">-0.05, 0.35</td>
</tr>
<tr class="even">
<td align="left">TimePost:Group10RM</td>
<td align="right">0.20</td>
<td align="left">0.05, 0.35</td>
</tr>
</tbody>
</table>
<p>The interpretation could be that the 10RM group increases strength more than the 30RM group, the 95% CI at time-point mid</p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
